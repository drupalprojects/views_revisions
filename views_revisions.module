<?php

/**
 * Implements hook_permission().
 */
function views_revisions_permission() {
  return array(
    'view views revisions' => array(
      'title' => t('View Views revisions')
    ),
    'revert views revisions' => array(
      'title' => t('Revert Views revisions')
    ),
    'delete views revisions' => array(
      'title' => t('Delete Views revisions')
    )
  );
}

/**
 * Implements hook_form_alter().
 */
function views_revisions_form_alter(&$form, &$form_state, $form_id) {
  if ($form_id == 'views_ui_edit_form') {
    $form['actions']['views_revisions_revision'] = array(
      '#type' => 'checkbox',
      '#title' => t('Create new revision')
    );
    $form['actions']['views_revisions_log'] = array(
      '#type' => 'textarea',
      '#title' => t('Revision log message'),
      '#description' => t('Provide an explanation of the changes you are making. This will help other authors understand your motivations.'),
      '#rows' => 3
    );
    $form['actions']['save']['#submit'][] = 'views_revisions_form_submit';
  }
}

/**
 * Submission handler for the Views UI form.
 */
function views_revisions_form_submit($form, &$form_state) {
  $revision = $form_state['values']['actions']['views_revisions_revision'];
  $log = $form_state['values']['actions']['views_revisions_log'];
}

